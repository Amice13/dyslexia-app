import{r as p,_ as G,g as H,u as K,p as J,i as Q,a as X,b as Z,w as ee,c as V,o as te,d as ae,e as ne,f as b,m as B,s as L,h as se,j as A,k as oe,l as re,n as ie,q as le,V as ue,t as x,v as D,x as v,y as R,z as y,A as _,B as M,C as h,D as C,E as ce}from"./index-DGljXUmV.js";import{u as de,V as O,f as fe,m as me}from"./forwardRefs-D7f93JFc.js";import{u as ve,a as pe,b as ke,m as ye,c as _e,d as ge,e as we,g as he,V as Re,f as be,h as T}from"./transition-DZh8pe1_.js";import{V as Se}from"./VMain-B6c4ulMH.js";import"./dimensions-DGCP30X1.js";function Ve(e={}){const{immediate:i=!1,onNeedRefresh:n,onOfflineReady:t,onRegistered:r,onRegisteredSW:o,onRegisterError:f}=e;let s,u,c;const d=async(a=!0)=>{await u,c?.()};async function k(){if("serviceWorker"in navigator){if(s=await G(async()=>{const{Workbox:a}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:a}},[]).then(({Workbox:a})=>new a("/dyslexia-app/sw.js",{scope:"/dyslexia-app/",type:"classic"})).catch(a=>{f?.(a)}),!s)return;c=()=>{s?.messageSkipWaiting()};{let a=!1;const g=()=>{a=!0,s?.addEventListener("controlling",m=>{m.isUpdate&&window.location.reload()}),n?.()};s.addEventListener("installed",m=>{typeof m.isUpdate>"u"?typeof m.isExternal<"u"&&m.isExternal?g():!a&&t?.():m.isUpdate||t?.()}),s.addEventListener("waiting",g)}s.register({immediate:i}).then(a=>{o?o("/dyslexia-app/sw.js",a):r?.(a)}).catch(a=>{f?.(a)})}}return u=k(),d}function Pe(e={}){const{immediate:i=!0,onNeedRefresh:n,onOfflineReady:t,onRegistered:r,onRegisteredSW:o,onRegisterError:f}=e,s=p(!1),u=p(!1);return{updateServiceWorker:Ve({immediate:i,onNeedRefresh(){s.value=!0,n?.()},onOfflineReady(){u.value=!0,t?.()},onRegistered:r,onRegisteredSW:o,onRegisterError:f}),offlineReady:u,needRefresh:s}}function xe(e){const i=L(e());let n=-1;function t(){clearInterval(n)}function r(){t(),le(()=>i.value=e())}function o(f){const s=f?getComputedStyle(f):{transitionDuration:.2},u=parseFloat(s.transitionDuration)*1e3||200;if(t(),i.value<=0)return;const c=performance.now();n=window.setInterval(()=>{const d=performance.now()-c+u;i.value=Math.max(e()-d,0),i.value<=0&&t()},u)}return se(t),{clear:t,time:i,start:o,reset:r}}const Ce=oe({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...we({location:"bottom"}),...ge(),..._e(),...ye(),...ie(),...re(me({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","retainFocus","captureFocus","disableInitialFocus","scrim","scrollStrategy","stickToTarget","viewportMargin"])},"VSnackbar"),Te=H()({name:"VSnackbar",props:Ce(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:n}=i;const t=K(e,"modelValue"),{positionClasses:r}=ve(e),{scopeId:o}=de(),{themeClasses:f}=J(e),{colorClasses:s,colorStyles:u,variantClasses:c}=pe(e),{roundedClasses:d}=ke(e),k=xe(()=>Number(e.timeout)),a=p(),g=p(),m=L(!1),E=L(0),W=p(),j=Q(ue,void 0);X(()=>!!j,()=>{const l=Z();ee(()=>{W.value=l.mainStyles.value})}),V(t,S),V(()=>e.timeout,S),te(()=>{t.value&&S()});let P=-1;function S(){k.reset(),window.clearTimeout(P);const l=Number(e.timeout);if(!t.value||l===-1)return;const w=ae(g.value);k.start(w),P=window.setTimeout(()=>{t.value=!1},l)}function F(){k.reset(),window.clearTimeout(P)}function I(){m.value=!0,F()}function N(){m.value=!1,S()}function U(l){E.value=l.touches[0].clientY}function Y(l){Math.abs(E.value-l.changedTouches[0].clientY)>50&&(t.value=!1)}function z(){m.value&&N()}const $=A(()=>e.location.split(" ").reduce((l,w)=>(l[`v-snackbar--${w}`]=!0,l),{}));return ne(()=>{const l=O.filterProps(e),w=!!(n.default||n.text||e.text);return b(O,B({ref:a,class:["v-snackbar",{"v-snackbar--active":t.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},$.value,r.value,e.class],style:[W.value,e.style]},l,{modelValue:t.value,"onUpdate:modelValue":q=>t.value=q,contentProps:B({class:["v-snackbar__wrapper",f.value,s.value,d.value,c.value],style:[u.value],onPointerenter:I,onPointerleave:N},l.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:U,onTouchend:Y,onAfterLeave:z},o),{default:()=>[he(!1,"v-snackbar"),e.timer&&!m.value&&x("div",{key:"timer",class:"v-snackbar__timer"},[b(Re,{ref:g,color:typeof e.timer=="string"?e.timer:"info",max:e.timeout,modelValue:k.time.value},null)]),w&&x("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[n.text?.()??e.text,n.default?.()]),n.actions&&b(be,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[x("div",{class:"v-snackbar__actions"},[n.actions({isActive:t})])]})],activator:n.activator})}),fe({},a)}}),Le={key:0},Ee={key:1},We=D({__name:"ThePwaReloadDialog",setup(e){const{offlineReady:i,needRefresh:n,updateServiceWorker:t}=Pe(),r=p(!1),o=p(!1);V(i,c=>{r.value=c}),V(n,c=>{o.value=c});const f=A(()=>r.value||o.value);function s(){r.value=!1,o.value=!1}async function u(){await t(),o.value=!1}return(c,d)=>(v(),R(Te,{"model-value":y(f),timeout:-1,color:"primary",class:"pwa-reload"},{actions:_(()=>[y(o)?(v(),R(T,{key:0,onClick:s,variant:"text"},{default:_(()=>[...d[0]||(d[0]=[C("Fermer",-1)])]),_:1})):h("",!0),y(o)?(v(),R(T,{key:1,onClick:u,variant:"tonal"},{default:_(()=>[...d[1]||(d[1]=[C("Mettre à jour",-1)])]),_:1})):h("",!0),y(r)?(v(),R(T,{key:2,onClick:s,variant:"text"},{default:_(()=>[...d[2]||(d[2]=[C("Ok",-1)])]),_:1})):h("",!0)]),default:_(()=>[y(r)?(v(),M("span",Le,"L'application est prête à fonctionner hors ligne")):h("",!0),y(o)?(v(),M("span",Ee,"Mettez à jour l'application")):h("",!0)]),_:1},8,["model-value"]))}}),De=D({__name:"default",setup(e){return(i,n)=>{const t=ce("router-view"),r=We;return v(),R(Se,null,{default:_(()=>[b(t),b(r)]),_:1})}}});export{De as default};
